[32mINFO    [0m pytest_operator.plugin:plugin.py:682 Connecting to existing model microk8s-localhost:test on unspecified cloud
[32mINFO    [0m juju.model:model.py:2097 Deploying ch:amd64/jammy/postgresql-k8s-204
[32mINFO    [0m juju.model:model.py:2097 Deploying local:jammy/pgbouncer-k8s-0
[32mINFO    [0m juju.model:model.py:2957 Waiting for model:
  postgresql-k8s/0 [allocating] waiting: installing agent
  postgresql-k8s/1 [allocating] waiting: installing agent
  postgresql-k8s/2 [allocating] waiting: installing agent
[32mINFO    [0m juju.model:model.py:2957 Waiting for model:
  pgbouncer-k8s/0 [allocating] waiting: installing agent
[32mINFO    [0m juju.model:model.py:2957 Waiting for model:
  pgbouncer-k8s/0 [idle] blocked: waiting for backend database relation to initialise
[32mINFO    [0m juju.model:model.py:2957 Waiting for model:
  postgresql-k8s/0 [executing] maintenance: installing charm software
  postgresql-k8s/1 [executing] maintenance: installing charm software
  postgresql-k8s/2 [executing] maintenance: installing charm software
[32mINFO    [0m juju.model:model.py:2957 Waiting for model:
  pgbouncer-k8s/0 [idle] blocked: waiting for backend database relation to initialise
[32mINFO    [0m juju.model:model.py:2957 Waiting for model:
  postgresql-k8s/0 [executing] waiting: awaiting for cluster to start
  postgresql-k8s/1 [idle] unknown: 
  postgresql-k8s/2 [idle] unknown: 
[32mINFO    [0m juju.model:model.py:2957 Waiting for model:
  postgresql-k8s/0 [executing] waiting: awaiting for primary endpoint to be ready
  postgresql-k8s/1 [idle] unknown: 
  postgresql-k8s/2 [idle] unknown: 
[32mINFO    [0m juju.model:model.py:2957 Waiting for model:
  postgresql-k8s/0 [idle] waiting: awaiting for primary endpoint to be ready
  postgresql-k8s/1 [idle] unknown: 
  postgresql-k8s/2 [idle] unknown: 
[32mINFO    [0m juju.model:model.py:2957 Waiting for model:
  postgresql-k8s/0 [executing] active: 
  postgresql-k8s/1 [idle] unknown: 
  postgresql-k8s/2 [idle] unknown: 
[32mINFO    [0m juju.model:model.py:2957 Waiting for model:
  postgresql-k8s/0 [executing] active: 
  postgresql-k8s/1 [executing] waiting: awaiting for member to start
  postgresql-k8s/2 [executing] waiting: awaiting for cluster to start
[32mINFO    [0m juju.model:model.py:2957 Waiting for model:
  postgresql-k8s/0 [executing] active: 
  postgresql-k8s/1 [idle] active: 
  postgresql-k8s/2 [idle] waiting: awaiting for member to start
[32mINFO    [0m juju.model:model.py:2957 Waiting for model:
  postgresql-k8s/0 [executing] active: 
  postgresql-k8s/1 [executing] active: 
  postgresql-k8s/2 [idle] active: 
[32mINFO    [0m juju.model:model.py:2957 Waiting for model:
  postgresql-k8s/1 [idle] active: 
[33mWARNING [0m juju.model:model.py:1563 relate is deprecated and will be removed. Use integrate instead.
[32mINFO    [0m juju.model:model.py:2957 Waiting for model:
  pgbouncer-k8s/0 [idle] blocked: waiting for backend database relation to initialise
  postgresql-k8s/0 [idle] active: Primary
  postgresql-k8s/1 [idle] active: 
  postgresql-k8s/2 [idle] active: 
[32mINFO    [0m juju.model:model.py:2957 Waiting for model:
  pgbouncer-k8s/0 [executing] active: backend-database relation initialised.
  postgresql-k8s/0 [idle] active: Primary
  postgresql-k8s/1 [idle] active: 
  postgresql-k8s/2 [idle] active: 
[32mINFO    [0m root:test_backend_database.py:80 {'databases': {}, 'pgbouncer': {'listen_addr': '*', 'listen_port': '6432', 'logfile': '/var/log/pgbouncer/instance_0/pgbouncer.log', 'pidfile': '/var/lib/pgbouncer/instance_0/pgbouncer.pid', 'stats_users': 'pgbouncer_stats_pgbouncer_k8s', 'auth_type': 'md5', 'user': 'postgres', 'max_client_conn': '10000', 'ignore_startup_parameters': 'extra_float_digits,options', 'server_tls_sslmode': 'prefer', 'so_reuseport': '1', 'unix_socket_dir': '/var/lib/pgbouncer/instance_0', 'pool_mode': 'session', 'max_db_connections': '100', 'default_pool_size': '13', 'min_pool_size': '7', 'reserve_pool_size': '7', 'auth_query': 'SELECT username, password FROM pgbouncer_auth_relation_id_5.get_auth($1)', 'auth_file': '/var/lib/pgbouncer/userlist.txt'}}
[32mINFO    [0m root:test_backend_database.py:91 {'data': '{"database": "pgbouncer", "extra-user-roles": "SUPERUSER", "requested-secrets": "[\\"username\\", \\"password\\", \\"tls\\", \\"tls-ca\\", \\"uris\\"]"}', 'database': 'pgbouncer', 'endpoints': 'postgresql-k8s-primary.test.svc.cluster.local:5432', 'read-only-endpoints': 'postgresql-k8s-replicas.test.svc.cluster.local:5432', 'secret-user': 'secret://5315e7e9-04bc-4354-84c9-a74b36867ba6/cnf8pkk8dins75mia0j0', 'version': '14.10'}
[32mINFO    [0m juju.model:model.py:2957 Waiting for model:
  postgresql-k8s/0 [executing] active: Primary
  postgresql-k8s/1 [executing] active: 
  postgresql-k8s/2 [executing] active: 
[32mINFO    [0m juju.model:model.py:2957 Waiting for model:
  pgbouncer-k8s/0 [executing] active: 
[32mINFO    [0m juju.model:model.py:2957 Waiting for model:
  pgbouncer-k8s/0 [idle] blocked: waiting for backend database relation to initialise
[32mINFO    [0m root:test_backend_database.py:111 {'databases': {}, 'pgbouncer': {'listen_addr': '*', 'listen_port': '6432', 'logfile': '/var/log/pgbouncer/instance_0/pgbouncer.log', 'pidfile': '/var/lib/pgbouncer/instance_0/pgbouncer.pid', 'stats_users': '', 'auth_type': 'md5', 'user': 'postgres', 'max_client_conn': '10000', 'ignore_startup_parameters': 'extra_float_digits,options', 'server_tls_sslmode': 'prefer', 'so_reuseport': '1', 'unix_socket_dir': '/var/lib/pgbouncer/instance_0', 'pool_mode': 'session', 'max_db_connections': '100', 'default_pool_size': '13', 'min_pool_size': '7', 'reserve_pool_size': '7', 'auth_query': '', 'auth_file': '/var/lib/pgbouncer/userlist.txt'}}