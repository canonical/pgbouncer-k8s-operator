[32mINFO    [0m pytest_operator.plugin:plugin.py:675 Connecting to existing model microk8s-localhost:test on unspecified cloud
[32mINFO    [0m juju.model:model.py:2087 Deploying ch:amd64/jammy/postgresql-k8s-193
[32mINFO    [0m juju.model:model.py:2087 Deploying local:jammy/pgbouncer-k8s-0
[32mINFO    [0m juju.model:model.py:2947 Waiting for model:
  postgresql-k8s/0 [allocating] waiting: installing agent
  postgresql-k8s/1 [allocating] waiting: installing agent
  postgresql-k8s/2 [allocating] waiting: installing agent
[32mINFO    [0m juju.model:model.py:2947 Waiting for model:
  pgbouncer-k8s/0 [allocating] waiting: installing agent
[32mINFO    [0m juju.model:model.py:2947 Waiting for model:
  postgresql-k8s/0 [executing] maintenance: installing charm software
  postgresql-k8s/1 [executing] maintenance: installing charm software
  postgresql-k8s/2 [executing] maintenance: installing charm software
[32mINFO    [0m juju.model:model.py:2947 Waiting for model:
  pgbouncer-k8s/0 [executing] blocked: waiting for backend database relation to initialise
[32mINFO    [0m juju.model:model.py:2947 Waiting for model:
  postgresql-k8s/0 [executing] unknown: 
  postgresql-k8s/1 [executing] unknown: 
  postgresql-k8s/2 [executing] unknown: 
[32mINFO    [0m juju.model:model.py:2947 Waiting for model:
  postgresql-k8s/0 [idle] unknown: 
  postgresql-k8s/1 [idle] unknown: 
  postgresql-k8s/2 [idle] unknown: 
[32mINFO    [0m juju.model:model.py:2947 Waiting for model:
  postgresql-k8s/0 [idle] waiting: awaiting for cluster to start
  postgresql-k8s/1 [idle] unknown: 
  postgresql-k8s/2 [idle] unknown: 
[32mINFO    [0m juju.model:model.py:2947 Waiting for model:
  postgresql-k8s/0 [executing] active: 
  postgresql-k8s/1 [idle] unknown: 
  postgresql-k8s/2 [idle] unknown: 
[32mINFO    [0m juju.model:model.py:2947 Waiting for model:
  postgresql-k8s/0 [idle] maintenance: reconfiguring cluster
  postgresql-k8s/1 [idle] waiting: awaiting for member to start
  postgresql-k8s/2 [idle] waiting: awaiting for cluster to start
[32mINFO    [0m juju.model:model.py:2947 Waiting for model:
  postgresql-k8s/0 [executing] active: 
  postgresql-k8s/1 [executing] active: 
  postgresql-k8s/2 [executing] active: 
[32mINFO    [0m juju.model:model.py:2947 Waiting for model:
  postgresql-k8s/1 [executing] active: 
[33mWARNING [0m juju.model:model.py:1553 relate is deprecated and will be removed. Use integrate instead.
[32mINFO    [0m juju.model:model.py:2947 Waiting for model:
  pgbouncer-k8s/0 [idle] blocked: waiting for backend database relation to initialise
  postgresql-k8s/0 [idle] active: Primary
  postgresql-k8s/1 [idle] active: 
  postgresql-k8s/2 [idle] active: 
[32mINFO    [0m juju.model:model.py:2947 Waiting for model:
  pgbouncer-k8s/0 [idle] active: 
  postgresql-k8s/0 [idle] active: Primary
  postgresql-k8s/1 [idle] active: 
  postgresql-k8s/2 [idle] active: 
[32mINFO    [0m root:test_backend_database.py:80 [databases]

[pgbouncer]
listen_addr = *
listen_port = 6432
logfile = /var/lib/postgresql/pgbouncer/pgbouncer.log
pidfile = /var/lib/postgresql/pgbouncer/pgbouncer.pid
admin_users = 
stats_users = pgbouncer_stats_pgbouncer_k8s
auth_type = md5
user = postgres
max_client_conn = 10000
ignore_startup_parameters = extra_float_digits,options
server_tls_sslmode = prefer
so_reuseport = 1
unix_socket_dir = /var/lib/postgresql/pgbouncer
pool_mode = session
max_db_connections = 100
default_pool_size = 13
min_pool_size = 7
reserve_pool_size = 7
auth_query = SELECT username, password FROM pgbouncer_auth_relation_id_5.get_auth($1)
auth_file = /var/lib/pgbouncer/userlist.txt


[32mINFO    [0m root:test_backend_database.py:91 {'data': '{"database": "pgbouncer", "extra-user-roles": "SUPERUSER", "requested-secrets": "[\\"username\\", \\"password\\", \\"tls\\", \\"tls-ca\\", \\"uris\\"]"}', 'database': 'pgbouncer', 'endpoints': 'postgresql-k8s-primary.test.svc.cluster.local:5432', 'read-only-endpoints': 'postgresql-k8s-replicas.test.svc.cluster.local:5432', 'secret-user': 'secret://9ee39550-8017-48d7-8013-99dd3e1769ab/cmveil6mpt5c75ajrt7g', 'version': '14.10'}
[32mINFO    [0m juju.model:model.py:2947 Waiting for model:
  pgbouncer-k8s/0 [executing] active: 
[32mINFO    [0m juju.model:model.py:2947 Waiting for model:
  postgresql-k8s/0 [executing] active: Primary
  postgresql-k8s/1 [executing] active: 
  postgresql-k8s/2 [executing] active: 
[32mINFO    [0m juju.model:model.py:2947 Waiting for model:
  pgbouncer-k8s/0 [idle] blocked: waiting for backend database relation to initialise
[32mINFO    [0m root:test_backend_database.py:111 [databases]

[pgbouncer]
listen_addr = *
listen_port = 6432
logfile = /var/lib/postgresql/pgbouncer/pgbouncer.log
pidfile = /var/lib/postgresql/pgbouncer/pgbouncer.pid
admin_users = 
stats_users = pgbouncer_stats_pgbouncer_k8s
auth_type = md5
user = postgres
max_client_conn = 10000
ignore_startup_parameters = extra_float_digits,options
server_tls_sslmode = prefer
so_reuseport = 1
unix_socket_dir = /var/lib/postgresql/pgbouncer
pool_mode = session
max_db_connections = 100
default_pool_size = 13
min_pool_size = 7
reserve_pool_size = 7